<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src package &mdash; alphailp v1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/alphailp_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="src.fol package" href="src.fol.html" />
    <link rel="prev" title="Acknowledgements" href="acknowledgements.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/aILP_logo_pink.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Building-a-Reasoner.html">Building a Reasoner</a></li>
<li class="toctree-l1"><a class="reference internal" href="Building-a-Learner.html">Building a Learner</a></li>
<li class="toctree-l1"><a class="reference internal" href="Compositional-Test.html">Compositional Test by Differentiable Reasoning</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="valuation.html">Valuation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="mode-declaration.html">Mode Declaration</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">src package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html">src.fol package</a></li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html">src.slot_attention package</a></li>
<li class="toctree-l3"><a class="reference internal" href="src.yolov5.html">src.yolov5 package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.clause_generator">src.clause_generator module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.clause_generator.ClauseGenerator"><code class="docutils literal notranslate"><span class="pre">ClauseGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.clause_generator.ClauseGenerator.beam_search"><code class="docutils literal notranslate"><span class="pre">ClauseGenerator.beam_search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.clause_generator.ClauseGenerator.beam_search_clause"><code class="docutils literal notranslate"><span class="pre">ClauseGenerator.beam_search_clause()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.clause_generator.ClauseGenerator.eval_clauses"><code class="docutils literal notranslate"><span class="pre">ClauseGenerator.eval_clauses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.clause_generator.ClauseGenerator.generate"><code class="docutils literal notranslate"><span class="pre">ClauseGenerator.generate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.clause_generator.ClauseGenerator.is_in_beam"><code class="docutils literal notranslate"><span class="pre">ClauseGenerator.is_in_beam()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.data_clevr">src.data_clevr module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.data_clevr.CLEVRHans"><code class="docutils literal notranslate"><span class="pre">CLEVRHans</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_clevr.CLEVRHans_POSITIVE"><code class="docutils literal notranslate"><span class="pre">CLEVRHans_POSITIVE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_clevr.load_images_and_labels"><code class="docutils literal notranslate"><span class="pre">load_images_and_labels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_clevr.load_images_and_labels_positive"><code class="docutils literal notranslate"><span class="pre">load_images_and_labels_positive()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.data_kandinsky">src.data_kandinsky module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.data_kandinsky.KANDINSKY"><code class="docutils literal notranslate"><span class="pre">KANDINSKY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_kandinsky.KANDINSKY_POSITIVE"><code class="docutils literal notranslate"><span class="pre">KANDINSKY_POSITIVE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_kandinsky.letterbox"><code class="docutils literal notranslate"><span class="pre">letterbox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_kandinsky.load_image_yolo"><code class="docutils literal notranslate"><span class="pre">load_image_yolo()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_kandinsky.load_images_and_labels"><code class="docutils literal notranslate"><span class="pre">load_images_and_labels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.data_kandinsky.load_images_and_labels_positive"><code class="docutils literal notranslate"><span class="pre">load_images_and_labels_positive()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.eval_clause_infer">src.eval_clause_infer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.eval_clause_infer.EvalInferModule"><code class="docutils literal notranslate"><span class="pre">EvalInferModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.eval_clause_infer.EvalInferModule.forward"><code class="docutils literal notranslate"><span class="pre">EvalInferModule.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.eval_clause_infer.EvalInferModule.init_identity_weights"><code class="docutils literal notranslate"><span class="pre">EvalInferModule.init_identity_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.eval_clause_infer.EvalInferModule.r"><code class="docutils literal notranslate"><span class="pre">EvalInferModule.r()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.eval_clause_infer.EvalInferModule.training"><code class="docutils literal notranslate"><span class="pre">EvalInferModule.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.facts_converter">src.facts_converter module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.facts_converter.FactsConverter"><code class="docutils literal notranslate"><span class="pre">FactsConverter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.call"><code class="docutils literal notranslate"><span class="pre">FactsConverter.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.convert"><code class="docutils literal notranslate"><span class="pre">FactsConverter.convert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.convert_i"><code class="docutils literal notranslate"><span class="pre">FactsConverter.convert_i()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.filter_by_datatype"><code class="docutils literal notranslate"><span class="pre">FactsConverter.filter_by_datatype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.forward"><code class="docutils literal notranslate"><span class="pre">FactsConverter.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.get_params"><code class="docutils literal notranslate"><span class="pre">FactsConverter.get_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.init_valuation"><code class="docutils literal notranslate"><span class="pre">FactsConverter.init_valuation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.to_vec"><code class="docutils literal notranslate"><span class="pre">FactsConverter.to_vec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.facts_converter.FactsConverter.training"><code class="docutils literal notranslate"><span class="pre">FactsConverter.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.infer">src.infer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.infer.ClauseFunction"><code class="docutils literal notranslate"><span class="pre">ClauseFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.ClauseFunction.forward"><code class="docutils literal notranslate"><span class="pre">ClauseFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.ClauseFunction.training"><code class="docutils literal notranslate"><span class="pre">ClauseFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.infer.ClauseInferModule"><code class="docutils literal notranslate"><span class="pre">ClauseInferModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.ClauseInferModule.forward"><code class="docutils literal notranslate"><span class="pre">ClauseInferModule.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.ClauseInferModule.r"><code class="docutils literal notranslate"><span class="pre">ClauseInferModule.r()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.ClauseInferModule.r_bk"><code class="docutils literal notranslate"><span class="pre">ClauseInferModule.r_bk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.ClauseInferModule.training"><code class="docutils literal notranslate"><span class="pre">ClauseInferModule.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.infer.InferModule"><code class="docutils literal notranslate"><span class="pre">InferModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.InferModule.forward"><code class="docutils literal notranslate"><span class="pre">InferModule.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.InferModule.get_params"><code class="docutils literal notranslate"><span class="pre">InferModule.get_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.InferModule.r"><code class="docutils literal notranslate"><span class="pre">InferModule.r()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.InferModule.r_bk"><code class="docutils literal notranslate"><span class="pre">InferModule.r_bk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.infer.InferModule.training"><code class="docutils literal notranslate"><span class="pre">InferModule.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.infer.init_identity_weights"><code class="docutils literal notranslate"><span class="pre">init_identity_weights()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.logic_utils">src.logic_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.build_clause_infer_module"><code class="docutils literal notranslate"><span class="pre">build_clause_infer_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.build_infer_module"><code class="docutils literal notranslate"><span class="pre">build_infer_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.generate_atoms"><code class="docutils literal notranslate"><span class="pre">generate_atoms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.generate_bk"><code class="docutils literal notranslate"><span class="pre">generate_bk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.get_index_by_predname"><code class="docutils literal notranslate"><span class="pre">get_index_by_predname()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.get_lang"><code class="docutils literal notranslate"><span class="pre">get_lang()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.get_searched_clauses"><code class="docutils literal notranslate"><span class="pre">get_searched_clauses()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.logic_utils.parse_clauses"><code class="docutils literal notranslate"><span class="pre">parse_clauses()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.mode_declaration">src.mode_declaration module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.mode_declaration.ModeDeclaration"><code class="docutils literal notranslate"><span class="pre">ModeDeclaration</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.mode_declaration.ModeTerm"><code class="docutils literal notranslate"><span class="pre">ModeTerm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.mode_declaration.get_mode_declarations"><code class="docutils literal notranslate"><span class="pre">get_mode_declarations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.mode_declaration.get_mode_declarations_clevr"><code class="docutils literal notranslate"><span class="pre">get_mode_declarations_clevr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.mode_declaration.get_mode_declarations_kandinsky"><code class="docutils literal notranslate"><span class="pre">get_mode_declarations_kandinsky()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.neural_utils">src.neural_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.neural_utils.LogisticRegression"><code class="docutils literal notranslate"><span class="pre">LogisticRegression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.neural_utils.LogisticRegression.forward"><code class="docutils literal notranslate"><span class="pre">LogisticRegression.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.neural_utils.LogisticRegression.training"><code class="docutils literal notranslate"><span class="pre">LogisticRegression.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.neural_utils.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.neural_utils.MLP.forward"><code class="docutils literal notranslate"><span class="pre">MLP.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.neural_utils.MLP.training"><code class="docutils literal notranslate"><span class="pre">MLP.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.nsfr">src.nsfr module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr.NSFReasoner"><code class="docutils literal notranslate"><span class="pre">NSFReasoner</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.atoms_to_text"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.atoms_to_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.clause_eval"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.clause_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.forward"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.get_clauses"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.get_clauses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.get_params"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.get_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.get_top_atoms"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.get_top_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.get_valuation_text"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.get_valuation_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.predict"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.predict_multi"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.predict_multi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.print_program"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.print_program()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.print_valuation_batch"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.print_valuation_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.nsfr.NSFReasoner.training"><code class="docutils literal notranslate"><span class="pre">NSFReasoner.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.nsfr_utils">src.nsfr_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.denormalize_clevr"><code class="docutils literal notranslate"><span class="pre">denormalize_clevr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.denormalize_kandinsky"><code class="docutils literal notranslate"><span class="pre">denormalize_kandinsky()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.generate_captions"><code class="docutils literal notranslate"><span class="pre">generate_captions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_clevr_loader"><code class="docutils literal notranslate"><span class="pre">get_clevr_loader()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_clevr_pos_loader"><code class="docutils literal notranslate"><span class="pre">get_clevr_pos_loader()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_data_loader"><code class="docutils literal notranslate"><span class="pre">get_data_loader()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_data_pos_loader"><code class="docutils literal notranslate"><span class="pre">get_data_pos_loader()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_kandinsky_loader"><code class="docutils literal notranslate"><span class="pre">get_kandinsky_loader()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_kandinsky_pos_loader"><code class="docutils literal notranslate"><span class="pre">get_kandinsky_pos_loader()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_nsfr_model"><code class="docutils literal notranslate"><span class="pre">get_nsfr_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_nsfr_model_train"><code class="docutils literal notranslate"><span class="pre">get_nsfr_model_train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_prob"><code class="docutils literal notranslate"><span class="pre">get_prob()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.get_prob_by_prednames"><code class="docutils literal notranslate"><span class="pre">get_prob_by_prednames()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.save_images_with_captions"><code class="docutils literal notranslate"><span class="pre">save_images_with_captions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.to_plot_images_clevr"><code class="docutils literal notranslate"><span class="pre">to_plot_images_clevr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.to_plot_images_kandinsky"><code class="docutils literal notranslate"><span class="pre">to_plot_images_kandinsky()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.update_initial_clauses"><code class="docutils literal notranslate"><span class="pre">update_initial_clauses()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.update_nsfr_clauses"><code class="docutils literal notranslate"><span class="pre">update_nsfr_clauses()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.valuation_to_attr_string"><code class="docutils literal notranslate"><span class="pre">valuation_to_attr_string()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.valuation_to_rel_string"><code class="docutils literal notranslate"><span class="pre">valuation_to_rel_string()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.valuation_to_string"><code class="docutils literal notranslate"><span class="pre">valuation_to_string()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.nsfr_utils.valuations_to_string"><code class="docutils literal notranslate"><span class="pre">valuations_to_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.optimizer">src.optimizer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.optimizer.WeightOptimizer"><code class="docutils literal notranslate"><span class="pre">WeightOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.optimizer.WeightOptimizer.minibatch"><code class="docutils literal notranslate"><span class="pre">WeightOptimizer.minibatch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.optimizer.WeightOptimizer.optimize_weights"><code class="docutils literal notranslate"><span class="pre">WeightOptimizer.optimize_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.optimizer.WeightOptimizer.set_optimizer"><code class="docutils literal notranslate"><span class="pre">WeightOptimizer.set_optimizer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.percept">src.percept module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.percept.SlotAttentionPerceptionModule"><code class="docutils literal notranslate"><span class="pre">SlotAttentionPerceptionModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.SlotAttentionPerceptionModule.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionPerceptionModule.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.SlotAttentionPerceptionModule.load_model"><code class="docutils literal notranslate"><span class="pre">SlotAttentionPerceptionModule.load_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.SlotAttentionPerceptionModule.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionPerceptionModule.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.percept.YOLOPerceptionModule"><code class="docutils literal notranslate"><span class="pre">YOLOPerceptionModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.YOLOPerceptionModule.forward"><code class="docutils literal notranslate"><span class="pre">YOLOPerceptionModule.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.YOLOPerceptionModule.load_model"><code class="docutils literal notranslate"><span class="pre">YOLOPerceptionModule.load_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.YOLOPerceptionModule.pad_result"><code class="docutils literal notranslate"><span class="pre">YOLOPerceptionModule.pad_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.YOLOPerceptionModule.training"><code class="docutils literal notranslate"><span class="pre">YOLOPerceptionModule.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.percept.YOLOPreprocess"><code class="docutils literal notranslate"><span class="pre">YOLOPreprocess</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.YOLOPreprocess.forward"><code class="docutils literal notranslate"><span class="pre">YOLOPreprocess.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.percept.YOLOPreprocess.training"><code class="docutils literal notranslate"><span class="pre">YOLOPreprocess.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.predict_clevr">src.predict_clevr module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.predict_clevr.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.predict_clevr.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.predict_clevr.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.predict_kandinsky">src.predict_kandinsky module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.predict_kandinsky.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.predict_kandinsky.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.predict_kandinsky.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.refinement">src.refinement module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.refinement.RefinementGenerator"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.add_atom"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.add_atom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.add_attribute_atom"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.add_attribute_atom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.add_relation_atom"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.add_relation_atom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.apply_func"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.apply_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.generate_new_variable"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.generate_new_variable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.generate_term_combinations"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.generate_term_combinations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.get_max_obj_id"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.get_max_obj_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.refine_from_modeb"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.refine_from_modeb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.refinement"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.refinement()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.refinement_clause"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.refinement_clause()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.subs_const"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.subs_const()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.refinement.RefinementGenerator.subs_var"><code class="docutils literal notranslate"><span class="pre">RefinementGenerator.subs_var()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.tensor_encoder">src.tensor_encoder module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder"><code class="docutils literal notranslate"><span class="pre">TensorEncoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.body_to_tensor"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.body_to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.build_I_c"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.build_I_c()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.build_fact_index_dic"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.build_fact_index_dic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.build_head_unifier_dic"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.build_head_unifier_dic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.encode"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.facts_to_index"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.facts_to_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.generate_subs"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.generate_subs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.get_fact_index"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.get_fact_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.get_max_subs_num"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.get_max_subs_num()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.tensor_encoder.TensorEncoder.pad_by_true"><code class="docutils literal notranslate"><span class="pre">TensorEncoder.pad_by_true()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.torch_utils">src.torch_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.torch_utils.logsumexp"><code class="docutils literal notranslate"><span class="pre">logsumexp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.torch_utils.print_valuation"><code class="docutils literal notranslate"><span class="pre">print_valuation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.torch_utils.softor"><code class="docutils literal notranslate"><span class="pre">softor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.torch_utils.weight_sum"><code class="docutils literal notranslate"><span class="pre">weight_sum()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.train">src.train module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.train.discretise_NSFR"><code class="docutils literal notranslate"><span class="pre">discretise_NSFR()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train.train_nsfr"><code class="docutils literal notranslate"><span class="pre">train_nsfr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.train_cnn">src.train_cnn module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn.compute_acc"><code class="docutils literal notranslate"><span class="pre">compute_acc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.train_cnn_clevr">src.train_cnn_clevr module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn_clevr.compute_acc"><code class="docutils literal notranslate"><span class="pre">compute_acc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn_clevr.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn_clevr.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn_clevr.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_cnn_clevr.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.train_sa_mlp_clevr">src.train_sa_mlp_clevr module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.train_sa_mlp_clevr.compute_acc"><code class="docutils literal notranslate"><span class="pre">compute_acc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_sa_mlp_clevr.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_sa_mlp_clevr.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_sa_mlp_clevr.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_sa_mlp_clevr.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.train_yolo_mlp">src.train_yolo_mlp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.train_yolo_mlp.compute_acc"><code class="docutils literal notranslate"><span class="pre">compute_acc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_yolo_mlp.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_yolo_mlp.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_yolo_mlp.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#src.train_yolo_mlp.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.valuation">src.valuation module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation.SlotAttentionValuationModule"><code class="docutils literal notranslate"><span class="pre">SlotAttentionValuationModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.SlotAttentionValuationModule.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionValuationModule.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.SlotAttentionValuationModule.ground_to_tensor"><code class="docutils literal notranslate"><span class="pre">SlotAttentionValuationModule.ground_to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.SlotAttentionValuationModule.init_valuation_functions"><code class="docutils literal notranslate"><span class="pre">SlotAttentionValuationModule.init_valuation_functions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.SlotAttentionValuationModule.term_to_onehot"><code class="docutils literal notranslate"><span class="pre">SlotAttentionValuationModule.term_to_onehot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.SlotAttentionValuationModule.to_onehot_batch"><code class="docutils literal notranslate"><span class="pre">SlotAttentionValuationModule.to_onehot_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.SlotAttentionValuationModule.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionValuationModule.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation.YOLOValuationModule"><code class="docutils literal notranslate"><span class="pre">YOLOValuationModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.YOLOValuationModule.forward"><code class="docutils literal notranslate"><span class="pre">YOLOValuationModule.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.YOLOValuationModule.ground_to_tensor"><code class="docutils literal notranslate"><span class="pre">YOLOValuationModule.ground_to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.YOLOValuationModule.init_attr_encodings"><code class="docutils literal notranslate"><span class="pre">YOLOValuationModule.init_attr_encodings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.YOLOValuationModule.init_valuation_functions"><code class="docutils literal notranslate"><span class="pre">YOLOValuationModule.init_valuation_functions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation.YOLOValuationModule.training"><code class="docutils literal notranslate"><span class="pre">YOLOValuationModule.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src.valuation_func">src.valuation_func module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionColorValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionColorValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionColorValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionColorValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionColorValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionColorValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionFrontValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionFrontValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionFrontValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionFrontValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionFrontValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionFrontValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionInValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionInValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionInValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionInValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionInValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionInValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionLeftSideValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionLeftSideValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionLeftSideValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionLeftSideValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionLeftSideValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionLeftSideValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionMaterialValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionMaterialValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionMaterialValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionMaterialValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionMaterialValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionMaterialValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionRightSideValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionRightSideValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionRightSideValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionRightSideValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionRightSideValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionRightSideValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionShapeValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionShapeValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionShapeValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionShapeValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionShapeValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionShapeValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.SlotAttentionSizeValuationFunction"><code class="docutils literal notranslate"><span class="pre">SlotAttentionSizeValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionSizeValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttentionSizeValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.SlotAttentionSizeValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">SlotAttentionSizeValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.YOLOClosebyValuationFunction"><code class="docutils literal notranslate"><span class="pre">YOLOClosebyValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOClosebyValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">YOLOClosebyValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOClosebyValuationFunction.to_center"><code class="docutils literal notranslate"><span class="pre">YOLOClosebyValuationFunction.to_center()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOClosebyValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">YOLOClosebyValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.YOLOColorValuationFunction"><code class="docutils literal notranslate"><span class="pre">YOLOColorValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOColorValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">YOLOColorValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOColorValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">YOLOColorValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.YOLOInValuationFunction"><code class="docutils literal notranslate"><span class="pre">YOLOInValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOInValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">YOLOInValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOInValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">YOLOInValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.YOLOOnlineValuationFunction"><code class="docutils literal notranslate"><span class="pre">YOLOOnlineValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOOnlineValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">YOLOOnlineValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOOnlineValuationFunction.to_center_x"><code class="docutils literal notranslate"><span class="pre">YOLOOnlineValuationFunction.to_center_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOOnlineValuationFunction.to_center_y"><code class="docutils literal notranslate"><span class="pre">YOLOOnlineValuationFunction.to_center_y()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOOnlineValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">YOLOOnlineValuationFunction.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#src.valuation_func.YOLOShapeValuationFunction"><code class="docutils literal notranslate"><span class="pre">YOLOShapeValuationFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOShapeValuationFunction.forward"><code class="docutils literal notranslate"><span class="pre">YOLOShapeValuationFunction.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#src.valuation_func.YOLOShapeValuationFunction.training"><code class="docutils literal notranslate"><span class="pre">YOLOShapeValuationFunction.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-src">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">alphailp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">src package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/src.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="src-package">
<h1>src package<a class="headerlink" href="#src-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="src.fol.html">src.fol package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="src.fol.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.fol.html#module-src.fol.data_utils">src.fol.data_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils"><code class="docutils literal notranslate"><span class="pre">DataUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.get_bk"><code class="docutils literal notranslate"><span class="pre">DataUtils.get_bk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.get_clauses"><code class="docutils literal notranslate"><span class="pre">DataUtils.get_clauses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.load_atoms"><code class="docutils literal notranslate"><span class="pre">DataUtils.load_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.load_clauses"><code class="docutils literal notranslate"><span class="pre">DataUtils.load_clauses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.load_consts"><code class="docutils literal notranslate"><span class="pre">DataUtils.load_consts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.load_language"><code class="docutils literal notranslate"><span class="pre">DataUtils.load_language()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.load_neural_preds"><code class="docutils literal notranslate"><span class="pre">DataUtils.load_neural_preds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.load_preds"><code class="docutils literal notranslate"><span class="pre">DataUtils.load_preds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.parse_clause"><code class="docutils literal notranslate"><span class="pre">DataUtils.parse_clause()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.parse_const"><code class="docutils literal notranslate"><span class="pre">DataUtils.parse_const()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.parse_funcs"><code class="docutils literal notranslate"><span class="pre">DataUtils.parse_funcs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.parse_neural_pred"><code class="docutils literal notranslate"><span class="pre">DataUtils.parse_neural_pred()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.data_utils.DataUtils.parse_pred"><code class="docutils literal notranslate"><span class="pre">DataUtils.parse_pred()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.fol.html#module-src.fol.exp_parser">src.fol.exp_parser module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree"><code class="docutils literal notranslate"><span class="pre">ExpTree</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.args"><code class="docutils literal notranslate"><span class="pre">ExpTree.args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.atom"><code class="docutils literal notranslate"><span class="pre">ExpTree.atom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.body"><code class="docutils literal notranslate"><span class="pre">ExpTree.body()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.clause"><code class="docutils literal notranslate"><span class="pre">ExpTree.clause()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.const"><code class="docutils literal notranslate"><span class="pre">ExpTree.const()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.functor"><code class="docutils literal notranslate"><span class="pre">ExpTree.functor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.predicate"><code class="docutils literal notranslate"><span class="pre">ExpTree.predicate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.small_chars"><code class="docutils literal notranslate"><span class="pre">ExpTree.small_chars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.term"><code class="docutils literal notranslate"><span class="pre">ExpTree.term()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.ExpTree.variable"><code class="docutils literal notranslate"><span class="pre">ExpTree.variable()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.exp_parser.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.fol.html#module-src.fol.language">src.fol.language module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.language.DataType"><code class="docutils literal notranslate"><span class="pre">DataType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.language.Language"><code class="docutils literal notranslate"><span class="pre">Language</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.language.Language.get_by_dtype"><code class="docutils literal notranslate"><span class="pre">Language.get_by_dtype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.language.Language.get_by_dtype_name"><code class="docutils literal notranslate"><span class="pre">Language.get_by_dtype_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.language.Language.get_const_by_name"><code class="docutils literal notranslate"><span class="pre">Language.get_const_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.language.Language.get_pred_by_name"><code class="docutils literal notranslate"><span class="pre">Language.get_pred_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.language.Language.get_var_and_dtype"><code class="docutils literal notranslate"><span class="pre">Language.get_var_and_dtype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.language.Language.term_index"><code class="docutils literal notranslate"><span class="pre">Language.term_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.fol.html#module-src.fol.logic">src.fol.logic module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom"><code class="docutils literal notranslate"><span class="pre">Atom</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.pred"><code class="docutils literal notranslate"><span class="pre">Atom.pred</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.terms"><code class="docutils literal notranslate"><span class="pre">Atom.terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.all_consts"><code class="docutils literal notranslate"><span class="pre">Atom.all_consts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.all_funcs"><code class="docutils literal notranslate"><span class="pre">Atom.all_funcs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.all_vars"><code class="docutils literal notranslate"><span class="pre">Atom.all_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.get_terms_by_dtype"><code class="docutils literal notranslate"><span class="pre">Atom.get_terms_by_dtype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.max_depth"><code class="docutils literal notranslate"><span class="pre">Atom.max_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.min_depth"><code class="docutils literal notranslate"><span class="pre">Atom.min_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.neg"><code class="docutils literal notranslate"><span class="pre">Atom.neg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.size"><code class="docutils literal notranslate"><span class="pre">Atom.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Atom.subs"><code class="docutils literal notranslate"><span class="pre">Atom.subs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause"><code class="docutils literal notranslate"><span class="pre">Clause</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.head"><code class="docutils literal notranslate"><span class="pre">Clause.head</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.body"><code class="docutils literal notranslate"><span class="pre">Clause.body</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.all_consts"><code class="docutils literal notranslate"><span class="pre">Clause.all_consts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.all_funcs"><code class="docutils literal notranslate"><span class="pre">Clause.all_funcs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.all_vars"><code class="docutils literal notranslate"><span class="pre">Clause.all_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.all_vars_by_dtype"><code class="docutils literal notranslate"><span class="pre">Clause.all_vars_by_dtype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.count_by_predicate"><code class="docutils literal notranslate"><span class="pre">Clause.count_by_predicate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.is_duplicate"><code class="docutils literal notranslate"><span class="pre">Clause.is_duplicate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.is_tautology"><code class="docutils literal notranslate"><span class="pre">Clause.is_tautology()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.max_depth"><code class="docutils literal notranslate"><span class="pre">Clause.max_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.min_depth"><code class="docutils literal notranslate"><span class="pre">Clause.min_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.size"><code class="docutils literal notranslate"><span class="pre">Clause.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Clause.subs"><code class="docutils literal notranslate"><span class="pre">Clause.subs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.Const"><code class="docutils literal notranslate"><span class="pre">Const</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.name"><code class="docutils literal notranslate"><span class="pre">Const.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.dtype"><code class="docutils literal notranslate"><span class="pre">Const.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.all_consts"><code class="docutils literal notranslate"><span class="pre">Const.all_consts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.all_funcs"><code class="docutils literal notranslate"><span class="pre">Const.all_funcs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.all_vars"><code class="docutils literal notranslate"><span class="pre">Const.all_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.get_ith_term"><code class="docutils literal notranslate"><span class="pre">Const.get_ith_term()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.head"><code class="docutils literal notranslate"><span class="pre">Const.head()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.is_var"><code class="docutils literal notranslate"><span class="pre">Const.is_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.max_depth"><code class="docutils literal notranslate"><span class="pre">Const.max_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.min_depth"><code class="docutils literal notranslate"><span class="pre">Const.min_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.size"><code class="docutils literal notranslate"><span class="pre">Const.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.subs"><code class="docutils literal notranslate"><span class="pre">Const.subs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Const.to_list"><code class="docutils literal notranslate"><span class="pre">Const.to_list()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncSymbol"><code class="docutils literal notranslate"><span class="pre">FuncSymbol</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncSymbol.name"><code class="docutils literal notranslate"><span class="pre">FuncSymbol.name</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm"><code class="docutils literal notranslate"><span class="pre">FuncTerm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.func_symbol"><code class="docutils literal notranslate"><span class="pre">FuncTerm.func_symbol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.args"><code class="docutils literal notranslate"><span class="pre">FuncTerm.args</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.all_consts"><code class="docutils literal notranslate"><span class="pre">FuncTerm.all_consts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.all_funcs"><code class="docutils literal notranslate"><span class="pre">FuncTerm.all_funcs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.all_vars"><code class="docutils literal notranslate"><span class="pre">FuncTerm.all_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.get_ith_symbol"><code class="docutils literal notranslate"><span class="pre">FuncTerm.get_ith_symbol()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.get_ith_term"><code class="docutils literal notranslate"><span class="pre">FuncTerm.get_ith_term()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.head"><code class="docutils literal notranslate"><span class="pre">FuncTerm.head()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.is_var"><code class="docutils literal notranslate"><span class="pre">FuncTerm.is_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.max_depth"><code class="docutils literal notranslate"><span class="pre">FuncTerm.max_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.min_depth"><code class="docutils literal notranslate"><span class="pre">FuncTerm.min_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.pre_order"><code class="docutils literal notranslate"><span class="pre">FuncTerm.pre_order()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.size"><code class="docutils literal notranslate"><span class="pre">FuncTerm.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.subs"><code class="docutils literal notranslate"><span class="pre">FuncTerm.subs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.FuncTerm.to_list"><code class="docutils literal notranslate"><span class="pre">FuncTerm.to_list()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.NeuralPredicate"><code class="docutils literal notranslate"><span class="pre">NeuralPredicate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.NeuralPredicate.name"><code class="docutils literal notranslate"><span class="pre">NeuralPredicate.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.NeuralPredicate.arity"><code class="docutils literal notranslate"><span class="pre">NeuralPredicate.arity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.NeuralPredicate.dtypes"><code class="docutils literal notranslate"><span class="pre">NeuralPredicate.dtypes</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.Predicate"><code class="docutils literal notranslate"><span class="pre">Predicate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Predicate.name"><code class="docutils literal notranslate"><span class="pre">Predicate.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Predicate.arity"><code class="docutils literal notranslate"><span class="pre">Predicate.arity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Predicate.dtypes"><code class="docutils literal notranslate"><span class="pre">Predicate.dtypes</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.Term"><code class="docutils literal notranslate"><span class="pre">Term</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.name"><code class="docutils literal notranslate"><span class="pre">Term.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.dtype"><code class="docutils literal notranslate"><span class="pre">Term.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.all_consts"><code class="docutils literal notranslate"><span class="pre">Term.all_consts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.all_funcs"><code class="docutils literal notranslate"><span class="pre">Term.all_funcs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.all_vars"><code class="docutils literal notranslate"><span class="pre">Term.all_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.is_var"><code class="docutils literal notranslate"><span class="pre">Term.is_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.max_depth"><code class="docutils literal notranslate"><span class="pre">Term.max_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.min_depth"><code class="docutils literal notranslate"><span class="pre">Term.min_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Term.size"><code class="docutils literal notranslate"><span class="pre">Term.size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.Var"><code class="docutils literal notranslate"><span class="pre">Var</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.name"><code class="docutils literal notranslate"><span class="pre">Var.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.all_consts"><code class="docutils literal notranslate"><span class="pre">Var.all_consts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.all_funcs"><code class="docutils literal notranslate"><span class="pre">Var.all_funcs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.all_vars"><code class="docutils literal notranslate"><span class="pre">Var.all_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.get_ith_term"><code class="docutils literal notranslate"><span class="pre">Var.get_ith_term()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.head"><code class="docutils literal notranslate"><span class="pre">Var.head()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.is_var"><code class="docutils literal notranslate"><span class="pre">Var.is_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.max_depth"><code class="docutils literal notranslate"><span class="pre">Var.max_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.min_depth"><code class="docutils literal notranslate"><span class="pre">Var.min_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.size"><code class="docutils literal notranslate"><span class="pre">Var.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.subs"><code class="docutils literal notranslate"><span class="pre">Var.subs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.fol.html#src.fol.logic.Var.to_list"><code class="docutils literal notranslate"><span class="pre">Var.to_list()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.fol.html#module-src.fol.logic_ops">src.fol.logic_ops module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.find_subs_term"><code class="docutils literal notranslate"><span class="pre">find_subs_term()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.get_disagree_index"><code class="docutils literal notranslate"><span class="pre">get_disagree_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.get_disagreements"><code class="docutils literal notranslate"><span class="pre">get_disagreements()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.is_entailed"><code class="docutils literal notranslate"><span class="pre">is_entailed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.is_singleton"><code class="docutils literal notranslate"><span class="pre">is_singleton()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.occur_check"><code class="docutils literal notranslate"><span class="pre">occur_check()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.subs"><code class="docutils literal notranslate"><span class="pre">subs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.subs_list"><code class="docutils literal notranslate"><span class="pre">subs_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.t_p"><code class="docutils literal notranslate"><span class="pre">t_p()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.t_p_n"><code class="docutils literal notranslate"><span class="pre">t_p_n()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.fol.html#src.fol.logic_ops.unify"><code class="docutils literal notranslate"><span class="pre">unify()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.fol.html#module-src.fol">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="src.slot_attention.html">src.slot_attention package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="src.slot_attention.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.slot_attention.html#module-src.slot_attention.data">src.slot_attention.data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.CLEVR"><code class="docutils literal notranslate"><span class="pre">CLEVR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.CLEVR.images_folder"><code class="docutils literal notranslate"><span class="pre">CLEVR.images_folder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.CLEVR.img_db"><code class="docutils literal notranslate"><span class="pre">CLEVR.img_db()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.CLEVR.load_image"><code class="docutils literal notranslate"><span class="pre">CLEVR.load_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.CLEVR.object_to_fv"><code class="docutils literal notranslate"><span class="pre">CLEVR.object_to_fv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.CLEVR.prepare_scenes"><code class="docutils literal notranslate"><span class="pre">CLEVR.prepare_scenes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.CLEVR.scenes_path"><code class="docutils literal notranslate"><span class="pre">CLEVR.scenes_path</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.data.get_loader"><code class="docutils literal notranslate"><span class="pre">get_loader()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.slot_attention.html#module-src.slot_attention.model">src.slot_attention.model module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.MLP.forward"><code class="docutils literal notranslate"><span class="pre">MLP.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.MLP.training"><code class="docutils literal notranslate"><span class="pre">MLP.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention"><code class="docutils literal notranslate"><span class="pre">SlotAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttention.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention.training"><code class="docutils literal notranslate"><span class="pre">SlotAttention.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_classifier"><code class="docutils literal notranslate"><span class="pre">SlotAttention_classifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_classifier.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttention_classifier.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_classifier.training"><code class="docutils literal notranslate"><span class="pre">SlotAttention_classifier.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_encoder"><code class="docutils literal notranslate"><span class="pre">SlotAttention_encoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_encoder.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttention_encoder.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_encoder.training"><code class="docutils literal notranslate"><span class="pre">SlotAttention_encoder.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_model"><code class="docutils literal notranslate"><span class="pre">SlotAttention_model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_model.forward"><code class="docutils literal notranslate"><span class="pre">SlotAttention_model.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SlotAttention_model.training"><code class="docutils literal notranslate"><span class="pre">SlotAttention_model.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SoftPositionEmbed"><code class="docutils literal notranslate"><span class="pre">SoftPositionEmbed</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SoftPositionEmbed.forward"><code class="docutils literal notranslate"><span class="pre">SoftPositionEmbed.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.SoftPositionEmbed.training"><code class="docutils literal notranslate"><span class="pre">SoftPositionEmbed.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.model.build_grid"><code class="docutils literal notranslate"><span class="pre">build_grid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.slot_attention.html#src-slot-attention-preprocess-images-module">src.slot_attention.preprocess-images module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.slot_attention.html#src-slot-attention-train-module">src.slot_attention.train module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.slot_attention.html#module-src.slot_attention.utils">src.slot_attention.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.utils.hungarian_loss"><code class="docutils literal notranslate"><span class="pre">hungarian_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.utils.hungarian_loss_per_sample"><code class="docutils literal notranslate"><span class="pre">hungarian_loss_per_sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.utils.hungarian_matching"><code class="docutils literal notranslate"><span class="pre">hungarian_matching()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.utils.outer"><code class="docutils literal notranslate"><span class="pre">outer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="src.slot_attention.html#src.slot_attention.utils.save_args"><code class="docutils literal notranslate"><span class="pre">save_args()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.slot_attention.html#module-src.slot_attention">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="src.yolov5.html">src.yolov5 package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="src.yolov5.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="src.yolov5.models.html">src.yolov5.models package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.models.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.models.html#module-src.yolov5.models.common">src.yolov5.models.common module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.models.html#module-src.yolov5.models.experimental">src.yolov5.models.experimental module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.models.html#module-src.yolov5.models.export">src.yolov5.models.export module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.models.html#module-src.yolov5.models.yolo">src.yolov5.models.yolo module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.models.html#module-src.yolov5.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.yolov5.utils.html">src.yolov5.utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.activations">src.yolov5.utils.activations module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.autoanchor">src.yolov5.utils.autoanchor module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.datasets">src.yolov5.utils.datasets module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.general">src.yolov5.utils.general module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.google_utils">src.yolov5.utils.google_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.loss">src.yolov5.utils.loss module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.metrics">src.yolov5.utils.metrics module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.plots">src.yolov5.utils.plots module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils.torch_utils">src.yolov5.utils.torch_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.yolov5.utils.html#module-src.yolov5.utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="src.yolov5.html#module-src.yolov5">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-src.clause_generator">
<span id="src-clause-generator-module"></span><h2>src.clause_generator module<a class="headerlink" href="#module-src.clause_generator" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.clause_generator.ClauseGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.clause_generator.</span></span><span class="sig-name descname"><span class="pre">ClauseGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_declarations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk_clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_xil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/clause_generator.html#ClauseGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.clause_generator.ClauseGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>clause generator by refinement and beam search
:param ilp_problem:
:type ilp_problem: .ilp_problem.ILPProblem
:param infer_step: number of steps in forward inference
:type infer_step: int
:param max_depth: max depth of nests of function symbols
:type max_depth: int
:param max_body_len: max number of atoms in body of clauses
:type max_body_len: int</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.clause_generator.ClauseGenerator.beam_search">
<span class="sig-name descname"><span class="pre">beam_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/clause_generator.html#ClauseGenerator.beam_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.clause_generator.ClauseGenerator.beam_search" title="Permalink to this definition"></a></dt>
<dd><p>generate clauses by beam-searching from initial clauses
Inputs
——
C_0 : Set[.logic.Clause]</p>
<blockquote>
<div><p>set of initial clauses</p>
</div></blockquote>
<dl class="simple">
<dt>T_beam<span class="classifier">int</span></dt><dd><p>number of steps in beam-searching</p>
</dd>
<dt>N_beam<span class="classifier">int</span></dt><dd><p>size of the beam</p>
</dd>
<dt>N_max<span class="classifier">int</span></dt><dd><p>maximum number of clauses to be generated</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>C</strong> – a set of generated clauses</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Set[.logic.Clause]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.clause_generator.ClauseGenerator.beam_search_clause">
<span class="sig-name descname"><span class="pre">beam_search_clause</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/clause_generator.html#ClauseGenerator.beam_search_clause"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.clause_generator.ClauseGenerator.beam_search_clause" title="Permalink to this definition"></a></dt>
<dd><p>perform beam-searching from a clause
Inputs
——
clause : Clause</p>
<blockquote>
<div><p>initial clause</p>
</div></blockquote>
<dl class="simple">
<dt>T_beam<span class="classifier">int</span></dt><dd><p>number of steps in beam-searching</p>
</dd>
<dt>N_beam<span class="classifier">int</span></dt><dd><p>size of the beam</p>
</dd>
<dt>N_max<span class="classifier">int</span></dt><dd><p>maximum number of clauses to be generated</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>C</strong> – a set of generated clauses</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Set[.logic.Clause]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.clause_generator.ClauseGenerator.eval_clauses">
<span class="sig-name descname"><span class="pre">eval_clauses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/clause_generator.html#ClauseGenerator.eval_clauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.clause_generator.ClauseGenerator.eval_clauses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.clause_generator.ClauseGenerator.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'beam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/clause_generator.html#ClauseGenerator.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.clause_generator.ClauseGenerator.generate" title="Permalink to this definition"></a></dt>
<dd><p>call clause generation function with or without beam-searching
Inputs
——
C_0 : Set[.logic.Clause]</p>
<blockquote>
<div><p>a set of initial clauses</p>
</div></blockquote>
<dl class="simple">
<dt>gen_mode<span class="classifier">string</span></dt><dd><p>a generation mode
‘beam’ - with beam-searching
‘naive’ - without beam-searching</p>
</dd>
<dt>T_beam<span class="classifier">int</span></dt><dd><p>number of steps in beam-searching</p>
</dd>
<dt>N_beam<span class="classifier">int</span></dt><dd><p>size of the beam</p>
</dd>
<dt>N_max<span class="classifier">int</span></dt><dd><p>maximum number of clauses to be generated</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>C</strong> – set of generated clauses</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Set[.logic.Clause]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.clause_generator.ClauseGenerator.is_in_beam">
<span class="sig-name descname"><span class="pre">is_in_beam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clause</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/clause_generator.html#ClauseGenerator.is_in_beam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.clause_generator.ClauseGenerator.is_in_beam" title="Permalink to this definition"></a></dt>
<dd><p>If score is the same, same predicates =&gt; duplication</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.data_clevr">
<span id="src-data-clevr-module"></span><h2>src.data_clevr module<a class="headerlink" href="#module-src.data_clevr" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.data_clevr.CLEVRHans">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.data_clevr.</span></span><span class="sig-name descname"><span class="pre">CLEVRHans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_clevr.html#CLEVRHans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_clevr.CLEVRHans" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>CLEVRHans dataset.
The implementations is mainly from <a class="reference external" href="https://github.com/ml-research/NeSyConceptLearner/blob/main/src/pretrain-slot-attention/data.py">https://github.com/ml-research/NeSyConceptLearner/blob/main/src/pretrain-slot-attention/data.py</a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.data_clevr.CLEVRHans_POSITIVE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.data_clevr.</span></span><span class="sig-name descname"><span class="pre">CLEVRHans_POSITIVE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_clevr.html#CLEVRHans_POSITIVE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_clevr.CLEVRHans_POSITIVE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>CLEVRHans dataset.
The implementations is mainly from <a class="reference external" href="https://github.com/ml-research/NeSyConceptLearner/blob/main/src/pretrain-slot-attention/data.py">https://github.com/ml-research/NeSyConceptLearner/blob/main/src/pretrain-slot-attention/data.py</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.data_clevr.load_images_and_labels">
<span class="sig-prename descclassname"><span class="pre">src.data_clevr.</span></span><span class="sig-name descname"><span class="pre">load_images_and_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'clevr-hans3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_clevr.html#load_images_and_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_clevr.load_images_and_labels" title="Permalink to this definition"></a></dt>
<dd><p>Load image paths and labels for clevr-hans dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.data_clevr.load_images_and_labels_positive">
<span class="sig-prename descclassname"><span class="pre">src.data_clevr.</span></span><span class="sig-name descname"><span class="pre">load_images_and_labels_positive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'clevr-hans0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_clevr.html#load_images_and_labels_positive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_clevr.load_images_and_labels_positive" title="Permalink to this definition"></a></dt>
<dd><p>Load image paths and labels for clevr-hans dataset.</p>
</dd></dl>

</section>
<section id="module-src.data_kandinsky">
<span id="src-data-kandinsky-module"></span><h2>src.data_kandinsky module<a class="headerlink" href="#module-src.data_kandinsky" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.data_kandinsky.KANDINSKY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.data_kandinsky.</span></span><span class="sig-name descname"><span class="pre">KANDINSKY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_kandinsky.html#KANDINSKY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_kandinsky.KANDINSKY" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Kandinsky Patterns dataset.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.data_kandinsky.KANDINSKY_POSITIVE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.data_kandinsky.</span></span><span class="sig-name descname"><span class="pre">KANDINSKY_POSITIVE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_kandinsky.html#KANDINSKY_POSITIVE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_kandinsky.KANDINSKY_POSITIVE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Kandinsky Patterns dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.data_kandinsky.letterbox">
<span class="sig-prename descclassname"><span class="pre">src.data_kandinsky.</span></span><span class="sig-name descname"><span class="pre">letterbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(640,</span> <span class="pre">640)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(114,</span> <span class="pre">114,</span> <span class="pre">114)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaleFill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaleup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_kandinsky.html#letterbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_kandinsky.letterbox" title="Permalink to this definition"></a></dt>
<dd><p>A utilitiy function for yolov5 model to make predictions. The implementation is from the yolov5 repository.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.data_kandinsky.load_image_yolo">
<span class="sig-prename descclassname"><span class="pre">src.data_kandinsky.</span></span><span class="sig-name descname"><span class="pre">load_image_yolo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_kandinsky.html#load_image_yolo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_kandinsky.load_image_yolo" title="Permalink to this definition"></a></dt>
<dd><p>Load an image using given path.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.data_kandinsky.load_images_and_labels">
<span class="sig-prename descclassname"><span class="pre">src.data_kandinsky.</span></span><span class="sig-name descname"><span class="pre">load_images_and_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'twopairs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_kandinsky.html#load_images_and_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_kandinsky.load_images_and_labels" title="Permalink to this definition"></a></dt>
<dd><p>Load image paths and labels for kandinsky dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.data_kandinsky.load_images_and_labels_positive">
<span class="sig-prename descclassname"><span class="pre">src.data_kandinsky.</span></span><span class="sig-name descname"><span class="pre">load_images_and_labels_positive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'twopairs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/data_kandinsky.html#load_images_and_labels_positive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.data_kandinsky.load_images_and_labels_positive" title="Permalink to this definition"></a></dt>
<dd><p>Load image paths and labels for kandinsky dataset.</p>
</dd></dl>

</section>
<section id="module-src.eval_clause_infer">
<span id="src-eval-clause-infer-module"></span><h2>src.eval_clause_infer module<a class="headerlink" href="#module-src.eval_clause_infer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.eval_clause_infer.EvalInferModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.eval_clause_infer.</span></span><span class="sig-name descname"><span class="pre">EvalInferModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/eval_clause_infer.html#EvalInferModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.eval_clause_infer.EvalInferModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A class of differentiable foward-chaining inference.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.eval_clause_infer.EvalInferModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/eval_clause_infer.html#EvalInferModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.eval_clause_infer.EvalInferModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>In the forward function we accept a Tensor of input data and we must return
a Tensor of output data. We can use Modules defined in the constructor as
well as arbitrary operators on Tensors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.eval_clause_infer.EvalInferModule.init_identity_weights">
<span class="sig-name descname"><span class="pre">init_identity_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/eval_clause_infer.html#EvalInferModule.init_identity_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.eval_clause_infer.EvalInferModule.init_identity_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.eval_clause_infer.EvalInferModule.r">
<span class="sig-name descname"><span class="pre">r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/eval_clause_infer.html#EvalInferModule.r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.eval_clause_infer.EvalInferModule.r" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.eval_clause_infer.EvalInferModule.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.eval_clause_infer.EvalInferModule.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src.facts_converter">
<span id="src-facts-converter-module"></span><h2>src.facts_converter module<a class="headerlink" href="#module-src.facts_converter" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.facts_converter.</span></span><span class="sig-name descname"><span class="pre">FactsConverter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perception_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuation_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>FactsConverter converts the output fromt the perception module to the valuation vector.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.call" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.convert">
<span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.convert" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.convert_i">
<span class="sig-name descname"><span class="pre">convert_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.convert_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.convert_i" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.filter_by_datatype">
<span class="sig-name descname"><span class="pre">filter_by_datatype</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.filter_by_datatype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.filter_by_datatype" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.get_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.init_valuation">
<span class="sig-name descname"><span class="pre">init_valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.init_valuation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.init_valuation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.to_vec">
<span class="sig-name descname"><span class="pre">to_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/facts_converter.html#FactsConverter.to_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.facts_converter.FactsConverter.to_vec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.facts_converter.FactsConverter.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.facts_converter.FactsConverter.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src.infer">
<span id="src-infer-module"></span><h2>src.infer module<a class="headerlink" href="#module-src.infer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.infer.ClauseFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.infer.</span></span><span class="sig-name descname"><span class="pre">ClauseFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#ClauseFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.ClauseFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A class of the clause function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.infer.ClauseFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#ClauseFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.ClauseFunction.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.infer.ClauseFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.infer.ClauseFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.infer.ClauseInferModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.infer.</span></span><span class="sig-name descname"><span class="pre">ClauseInferModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_bk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#ClauseInferModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.ClauseInferModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="src.infer.ClauseInferModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#ClauseInferModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.ClauseInferModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>In the forward function we accept a Tensor of input data and we must return
a Tensor of output data. We can use Modules defined in the constructor as
well as arbitrary operators on Tensors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.infer.ClauseInferModule.r">
<span class="sig-name descname"><span class="pre">r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#ClauseInferModule.r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.ClauseInferModule.r" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.infer.ClauseInferModule.r_bk">
<span class="sig-name descname"><span class="pre">r_bk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#ClauseInferModule.r_bk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.ClauseInferModule.r_bk" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.infer.ClauseInferModule.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.infer.ClauseInferModule.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.infer.InferModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.infer.</span></span><span class="sig-name descname"><span class="pre">InferModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_bk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#InferModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.InferModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="src.infer.InferModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#InferModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.InferModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>In the forward function we accept a Tensor of input data and we must return
a Tensor of output data. We can use Modules defined in the constructor as
well as arbitrary operators on Tensors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.infer.InferModule.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#InferModule.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.InferModule.get_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.infer.InferModule.r">
<span class="sig-name descname"><span class="pre">r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#InferModule.r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.InferModule.r" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.infer.InferModule.r_bk">
<span class="sig-name descname"><span class="pre">r_bk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#InferModule.r_bk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.InferModule.r_bk" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.infer.InferModule.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.infer.InferModule.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.infer.init_identity_weights">
<span class="sig-prename descclassname"><span class="pre">src.infer.</span></span><span class="sig-name descname"><span class="pre">init_identity_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/infer.html#init_identity_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.infer.init_identity_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.logic_utils">
<span id="src-logic-utils-module"></span><h2>src.logic_utils module<a class="headerlink" href="#module-src.logic_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.build_clause_infer_module">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">build_clause_infer_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk_clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#build_clause_infer_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.build_clause_infer_module" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.build_infer_module">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">build_infer_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk_clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#build_infer_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.build_infer_module" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.generate_atoms">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">generate_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#generate_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.generate_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.generate_bk">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">generate_bk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#generate_bk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.generate_bk" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.get_index_by_predname">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">get_index_by_predname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#get_index_by_predname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.get_index_by_predname" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.get_lang">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">get_lang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lark_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang_base_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#get_lang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.get_lang" title="Permalink to this definition"></a></dt>
<dd><p>Load the language of first-order logic from files.</p>
<p>Read the language, clauses, background knowledge from files.
Atoms are generated from the language.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.get_searched_clauses">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">get_searched_clauses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lark_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang_base_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#get_searched_clauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.get_searched_clauses" title="Permalink to this definition"></a></dt>
<dd><p>Load the language of first-order logic from files.</p>
<p>Read the language, clauses, background knowledge from files.
Atoms are generated from the language.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.logic_utils.parse_clauses">
<span class="sig-prename descclassname"><span class="pre">src.logic_utils.</span></span><span class="sig-name descname"><span class="pre">parse_clauses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clause_strs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/logic_utils.html#parse_clauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.logic_utils.parse_clauses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.mode_declaration">
<span id="src-mode-declaration-module"></span><h2>src.mode_declaration module<a class="headerlink" href="#module-src.mode_declaration" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.mode_declaration.ModeDeclaration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.mode_declaration.</span></span><span class="sig-name descname"><span class="pre">ModeDeclaration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_terms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mode_declaration.html#ModeDeclaration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mode_declaration.ModeDeclaration" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>from <a class="reference external" href="https://www.cs.ox.ac.uk/activities/programinduction/Aleph/aleph.html">https://www.cs.ox.ac.uk/activities/programinduction/Aleph/aleph.html</a>
p(ModeType, ModeType,…)</p>
<p>Here are some examples of how they appear in a file:</p>
<p>:- mode(1,mem(+number,+list)).
:- mode(1,dec(+integer,-integer)).
:- mode(1,mult(+integer,+integer,-integer)).
:- mode(1,plus(+integer,+integer,-integer)).
:- mode(1,(+integer)=(#integer)).
:- mode(<a href="#id1"><span class="problematic" id="id2">*</span></a>,has_car(+train,-car)).
Each ModeType is either (a) simple; or (b) structured.
A simple ModeType is one of:
(a) +T specifying that when a literal with predicate symbol p appears in a
hypothesised clause, the corresponding argument should be an “input” variable of type T;
(b) -T specifying that the argument is an “output” variable of type T; or
(c) #T specifying that it should be a constant of type T.
All the examples above have simple modetypes.
A structured ModeType is of the form f(..) where f is a function symbol,
each argument of which is either a simple or structured ModeType.
Here is an example containing a structured ModeType:</p>
<p>To make this more clear, here is an example for the mode declarations for
the grandfather task from</p>
<blockquote>
<div><dl>
<dt>above::- modeh(1, grandfather(+human, +human)).:-</dt><dd><dl>
<dt>modeb(<a href="#id3"><span class="problematic" id="id4">*</span></a>, parent(-human, +human)).:-</dt><dd><p>modeb(<a href="#id5"><span class="problematic" id="id6">*</span></a>, male(+human)).
The  first  mode  states  that  the  head  of  the  rule</p>
<blockquote>
<div><dl>
<dt>(and  therefore  the  targetpredicate) will be the atomgrandfather.</dt><dd><dl>
<dt>Its parameters have to be of the typehuman.</dt><dd><dl>
<dt>The  +  annotation  says  that  the  rule  head  needs  two  variables.</dt><dd><dl>
<dt>Thesecond mode declaration states theparentatom and declares again</dt><dd><dl>
<dt>that theparameters have to be of type human.</dt><dd><p>Here,  the + at the second parametertells, that the system is only allowed to
introduce the atomparentin the clauseif it already contains a variable of type human.</p>
<blockquote>
<div><p>The−at the first attribute in-troduces a new variable into the clause.</p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>The  modes  consist  of  a  recall n that  states  how  many  versions  of  the
literal are allowed in a rule and an atom with place-markers that state the literal to-gether
with annotations on input- and output-variables as well as constants (see[Mug95]).
:param recall: The recall number i.e. how many times the declaration can be instanciated
:type recall: int
:param pred: The predicate.
:type pred: Predicate
:param mode_terms: Terms for mode declarations.
:type mode_terms: ModeTerm</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.mode_declaration.ModeTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.mode_declaration.</span></span><span class="sig-name descname"><span class="pre">ModeTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mode_declaration.html#ModeTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mode_declaration.ModeTerm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Terms for mode declarations. It has mode (+, -, #) and data types.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.mode_declaration.get_mode_declarations">
<span class="sig-prename descclassname"><span class="pre">src.mode_declaration.</span></span><span class="sig-name descname"><span class="pre">get_mode_declarations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mode_declaration.html#get_mode_declarations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mode_declaration.get_mode_declarations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.mode_declaration.get_mode_declarations_clevr">
<span class="sig-prename descclassname"><span class="pre">src.mode_declaration.</span></span><span class="sig-name descname"><span class="pre">get_mode_declarations_clevr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mode_declaration.html#get_mode_declarations_clevr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mode_declaration.get_mode_declarations_clevr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.mode_declaration.get_mode_declarations_kandinsky">
<span class="sig-prename descclassname"><span class="pre">src.mode_declaration.</span></span><span class="sig-name descname"><span class="pre">get_mode_declarations_kandinsky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mode_declaration.html#get_mode_declarations_kandinsky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mode_declaration.get_mode_declarations_kandinsky" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.neural_utils">
<span id="src-neural-utils-module"></span><h2>src.neural_utils module<a class="headerlink" href="#module-src.neural_utils" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.neural_utils.LogisticRegression">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.neural_utils.</span></span><span class="sig-name descname"><span class="pre">LogisticRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/neural_utils.html#LogisticRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.neural_utils.LogisticRegression" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="src.neural_utils.LogisticRegression.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/neural_utils.html#LogisticRegression.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.neural_utils.LogisticRegression.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.neural_utils.LogisticRegression.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.neural_utils.LogisticRegression.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.neural_utils.MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.neural_utils.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/neural_utils.html#MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.neural_utils.MLP" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="src.neural_utils.MLP.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/neural_utils.html#MLP.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.neural_utils.MLP.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.neural_utils.MLP.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.neural_utils.MLP.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src.nsfr">
<span id="src-nsfr-module"></span><h2>src.nsfr module<a class="headerlink" href="#module-src.nsfr" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.nsfr.</span></span><span class="sig-name descname"><span class="pre">NSFReasoner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perception_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facts_converter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clause_infer_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The Neuro-Symbolic Forward Reasoner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>perception_model</strong> (<em>nn.Module</em>) – The perception model.</p></li>
<li><p><strong>facts_converter</strong> (<em>nn.Module</em>) – The facts converter module.</p></li>
<li><p><strong>infer_module</strong> (<em>nn.Module</em>) – The differentiable forward-chaining inference module.</p></li>
<li><p><strong>atoms</strong> (<em>list</em><em>(</em><em>atom</em><em>)</em>) – The set of ground atoms (facts).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.atoms_to_text">
<span class="sig-name descname"><span class="pre">atoms_to_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.atoms_to_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.atoms_to_text" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.clause_eval">
<span class="sig-name descname"><span class="pre">clause_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.clause_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.clause_eval" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.get_clauses">
<span class="sig-name descname"><span class="pre">get_clauses</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.get_clauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.get_clauses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.get_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.get_top_atoms">
<span class="sig-name descname"><span class="pre">get_top_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.get_top_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.get_top_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.get_valuation_text">
<span class="sig-name descname"><span class="pre">get_valuation_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">valuation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.get_valuation_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.get_valuation_text" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.predict" title="Permalink to this definition"></a></dt>
<dd><p>Extracting a value from the valuation tensor using a given predicate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.predict_multi">
<span class="sig-name descname"><span class="pre">predict_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prednames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.predict_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.predict_multi" title="Permalink to this definition"></a></dt>
<dd><p>Extracting values from the valuation tensor using given predicates.</p>
<p>prednames = [‘kp1’, ‘kp2’, ‘kp3’]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.print_program">
<span class="sig-name descname"><span class="pre">print_program</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.print_program"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.print_program" title="Permalink to this definition"></a></dt>
<dd><p>Print asummary of logic programs using continuous weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.print_valuation_batch">
<span class="sig-name descname"><span class="pre">print_valuation_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">valuation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr.html#NSFReasoner.print_valuation_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr.NSFReasoner.print_valuation_batch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.nsfr.NSFReasoner.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.nsfr.NSFReasoner.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src.nsfr_utils">
<span id="src-nsfr-utils-module"></span><h2>src.nsfr_utils module<a class="headerlink" href="#module-src.nsfr_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.denormalize_clevr">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">denormalize_clevr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#denormalize_clevr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.denormalize_clevr" title="Permalink to this definition"></a></dt>
<dd><p>denormalize clevr images</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.denormalize_kandinsky">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">denormalize_kandinsky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#denormalize_kandinsky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.denormalize_kandinsky" title="Permalink to this definition"></a></dt>
<dd><p>denormalize kandinsky images</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.generate_captions">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">generate_captions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#generate_captions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.generate_captions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_clevr_loader">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_clevr_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_clevr_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_clevr_loader" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_clevr_pos_loader">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_clevr_pos_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_clevr_pos_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_clevr_pos_loader" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_data_loader">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_data_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_data_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_data_loader" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_data_pos_loader">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_data_pos_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_data_pos_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_data_pos_loader" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_kandinsky_loader">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_kandinsky_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_kandinsky_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_kandinsky_loader" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_kandinsky_pos_loader">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_kandinsky_pos_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_kandinsky_pos_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_kandinsky_pos_loader" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_nsfr_model">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_nsfr_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk_clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_nsfr_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_nsfr_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_nsfr_model_train">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_nsfr_model_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_nsfr_model_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_nsfr_model_train" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_prob">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_prob" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>if args.dataset_type == ‘kandinsky’:</dt><dd><p>predicted = NSFR.predict(v=v_T, predname=’kp’)</p>
</dd>
<dt>elif args.dataset_type == ‘clevr’:</dt><dd><dl class="simple">
<dt>if args.dataset == ‘clevr-hans3’:</dt><dd><dl class="simple">
<dt>predicted = NSFR.predict_multi(</dt><dd><p>v=v_T, prednames=[‘kp1’, ‘kp2’, ‘kp3’])</p>
</dd>
</dl>
</dd>
<dt>if args.dataset == ‘clevr-hans7’:</dt><dd><dl class="simple">
<dt>predicted = NSFR.predict_multi(</dt><dd><p>v=v_T, prednames=[‘kp1’, ‘kp2’, ‘kp3’, ‘kp4’, ‘kp5’, ‘kp6’, ‘kp7’])</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.get_prob_by_prednames">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">get_prob_by_prednames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prednames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#get_prob_by_prednames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.get_prob_by_prednames" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.save_images_with_captions">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">save_images_with_captions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">captions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_id_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#save_images_with_captions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.save_images_with_captions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.to_plot_images_clevr">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">to_plot_images_clevr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#to_plot_images_clevr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.to_plot_images_clevr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.to_plot_images_kandinsky">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">to_plot_images_kandinsky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#to_plot_images_kandinsky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.to_plot_images_kandinsky" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.update_initial_clauses">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">update_initial_clauses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#update_initial_clauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.update_initial_clauses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.update_nsfr_clauses">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">update_nsfr_clauses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsfr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk_clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#update_nsfr_clauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.update_nsfr_clauses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.valuation_to_attr_string">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">valuation_to_attr_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#valuation_to_attr_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.valuation_to_attr_string" title="Permalink to this definition"></a></dt>
<dd><p>Generate string explanations of the scene.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.valuation_to_rel_string">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">valuation_to_rel_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#valuation_to_rel_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.valuation_to_rel_string" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.valuation_to_string">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">valuation_to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#valuation_to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.valuation_to_string" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.nsfr_utils.valuations_to_string">
<span class="sig-prename descclassname"><span class="pre">src.nsfr_utils.</span></span><span class="sig-name descname"><span class="pre">valuations_to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/nsfr_utils.html#valuations_to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.nsfr_utils.valuations_to_string" title="Permalink to this definition"></a></dt>
<dd><p>Generate string explanation of the scenes.</p>
</dd></dl>

</section>
<section id="module-src.optimizer">
<span id="src-optimizer-module"></span><h2>src.optimizer module<a class="headerlink" href="#module-src.optimizer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.optimizer.WeightOptimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.optimizer.</span></span><span class="sig-name descname"><span class="pre">WeightOptimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infer_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/optimizer.html#WeightOptimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.optimizer.WeightOptimizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>optimizer of clause weights using gradient descent</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.optimizer.WeightOptimizer.minibatch">
<span class="sig-name descname"><span class="pre">minibatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/optimizer.html#WeightOptimizer.minibatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.optimizer.WeightOptimizer.minibatch" title="Permalink to this definition"></a></dt>
<dd><p>get minibatch
Inputs
——
probs : torch.tensor((<a href="#id7"><span class="problematic" id="id8">|train_idxs|</span></a>, ))</p>
<blockquote>
<div><p>valuation vector of examples
each dimension represents each example of the ilp problem</p>
</div></blockquote>
<dl>
<dt>labels<span class="classifier">torch.tensor((<a href="#id9"><span class="problematic" id="id10">|train_idxs|</span></a>, ))</span></dt><dd><p>label vector of examples
each dimension represents each example of the ilp problem</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>probs_batch</strong> (<em>torch.tensor((batch_size, ))</em>) – valuation vector of examples selected in the minibatch
each dimension represents each example of the ilp problem</p></li>
<li><p><strong>labels_batch</strong> (<em>torch.tensor((batch_size, ))</em>) – label vector of examples selected in the minibatch
each dimension represents each example of the ilp problem</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.optimizer.WeightOptimizer.optimize_weights">
<span class="sig-name descname"><span class="pre">optimize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/optimizer.html#WeightOptimizer.optimize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.optimizer.WeightOptimizer.optimize_weights" title="Permalink to this definition"></a></dt>
<dd><p>perform gradient descent to optimize clause weights
Inputs
——
epoch : int</p>
<blockquote>
<div><p>number of steps in gradient descent</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>IM</strong> (<em>.infer.InferModule</em>) – infer module that contains optimized weight vectors</p></li>
<li><p><strong>loss_list</strong> (<em>List[float]</em>) – list of training loss</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.optimizer.WeightOptimizer.set_optimizer">
<span class="sig-name descname"><span class="pre">set_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/optimizer.html#WeightOptimizer.set_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.optimizer.WeightOptimizer.set_optimizer" title="Permalink to this definition"></a></dt>
<dd><p>set torch optimizer</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.percept">
<span id="src-percept-module"></span><h2>src.percept module<a class="headerlink" href="#module-src.percept" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.percept.SlotAttentionPerceptionModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.percept.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionPerceptionModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#SlotAttentionPerceptionModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.SlotAttentionPerceptionModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A perception module using Slot Attention.</p>
<dl class="simple">
<dt>Attrs:</dt><dd><p>e (int): The maximum number of entities.
d (int): The dimension of the object-centric vector.
device (device): The device where the model and tensors are loaded.
train (bool): The flag if the parameters are trained.
preprocess (tensor-&gt;tensor): Reshape the yolo output into the unified format of the perceptiom module.
model: The slot attention model.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.percept.SlotAttentionPerceptionModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#SlotAttentionPerceptionModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.SlotAttentionPerceptionModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.percept.SlotAttentionPerceptionModule.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#SlotAttentionPerceptionModule.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.SlotAttentionPerceptionModule.load_model" title="Permalink to this definition"></a></dt>
<dd><p>Load slot attention network.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.percept.SlotAttentionPerceptionModule.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.percept.SlotAttentionPerceptionModule.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.percept.YOLOPerceptionModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.percept.</span></span><span class="sig-name descname"><span class="pre">YOLOPerceptionModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#YOLOPerceptionModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.YOLOPerceptionModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A perception module using YOLO.</p>
<dl class="simple">
<dt>Attrs:</dt><dd><p>e (int): The maximum number of entities.
d (int): The dimension of the object-centric vector.
device (device): The device where the model and tensors are loaded.
train (bool): The flag if the parameters are trained.
preprocess (tensor-&gt;tensor): Reshape the yolo output into the unified format of the perceptiom module.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.percept.YOLOPerceptionModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#YOLOPerceptionModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.YOLOPerceptionModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.percept.YOLOPerceptionModule.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#YOLOPerceptionModule.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.YOLOPerceptionModule.load_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.percept.YOLOPerceptionModule.pad_result">
<span class="sig-name descname"><span class="pre">pad_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#YOLOPerceptionModule.pad_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.YOLOPerceptionModule.pad_result" title="Permalink to this definition"></a></dt>
<dd><p>Padding the result by zeros.
(batch, n_obj, 6) -&gt; (batch, n_max_obj, 6)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.percept.YOLOPerceptionModule.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.percept.YOLOPerceptionModule.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.percept.YOLOPreprocess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.percept.</span></span><span class="sig-name descname"><span class="pre">YOLOPreprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#YOLOPreprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.YOLOPreprocess" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A perception module using Slot Attention.</p>
<dl class="simple">
<dt>Attrs:</dt><dd><p>device (device): The device where the model to be loaded.
img_size (int): The size of the (resized) image to normalize the xy-coordinates.
classes (list(str)): The classes of objects.
colors (tensor(int)): The one-hot encodings of the colors (repeated 3 times).
shapes (tensor(int)): The one-hot encodings of the shapes (repeated 3 times).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.percept.YOLOPreprocess.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/percept.html#YOLOPreprocess.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.percept.YOLOPreprocess.forward" title="Permalink to this definition"></a></dt>
<dd><p>A preprocess funciton for the YOLO model. The format is: [x1, y1, x2, y2, prob, class].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tensor</em>) – The output of the YOLO model. The format is:</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The preprocessed object-centric representation Z. The format is: [x1, y1, x2, y2, color1, color2, color3, shape1, shape2, shape3, objectness].
x1,x2,y1,y2 are normalized to [0-1].
The probability for each attribute is obtained by copying the probability of the classification of the YOLO model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Z (tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.percept.YOLOPreprocess.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.percept.YOLOPreprocess.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src.predict_clevr">
<span id="src-predict-clevr-module"></span><h2>src.predict_clevr module<a class="headerlink" href="#module-src.predict_clevr" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.predict_clevr.get_args">
<span class="sig-prename descclassname"><span class="pre">src.predict_clevr.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/predict_clevr.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.predict_clevr.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.predict_clevr.main">
<span class="sig-prename descclassname"><span class="pre">src.predict_clevr.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/predict_clevr.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.predict_clevr.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.predict_clevr.predict">
<span class="sig-prename descclassname"><span class="pre">src.predict_clevr.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/predict_clevr.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.predict_clevr.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.predict_kandinsky">
<span id="src-predict-kandinsky-module"></span><h2>src.predict_kandinsky module<a class="headerlink" href="#module-src.predict_kandinsky" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.predict_kandinsky.get_args">
<span class="sig-prename descclassname"><span class="pre">src.predict_kandinsky.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/predict_kandinsky.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.predict_kandinsky.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.predict_kandinsky.main">
<span class="sig-prename descclassname"><span class="pre">src.predict_kandinsky.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/predict_kandinsky.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.predict_kandinsky.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.predict_kandinsky.predict">
<span class="sig-prename descclassname"><span class="pre">src.predict_kandinsky.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/predict_kandinsky.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.predict_kandinsky.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.refinement">
<span id="src-refinement-module"></span><h2>src.refinement module<a class="headerlink" href="#module-src.refinement" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.refinement.</span></span><span class="sig-name descname"><span class="pre">RefinementGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_declarations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>refinement operations for clause generation
:param lang:
:type lang: .language.Language
:param max_depth: max depth of nests of function symbols
:type max_depth: int
:param max_body_len: max number of atoms in body of clauses
:type max_body_len: int</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.add_atom">
<span class="sig-name descname"><span class="pre">add_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.add_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.add_atom" title="Permalink to this definition"></a></dt>
<dd><p>add p(x_1, …, x_n) to the body</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.add_attribute_atom">
<span class="sig-name descname"><span class="pre">add_attribute_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.add_attribute_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.add_attribute_atom" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.add_relation_atom">
<span class="sig-name descname"><span class="pre">add_relation_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.add_relation_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.add_relation_atom" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.apply_func">
<span class="sig-name descname"><span class="pre">apply_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.apply_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.apply_func" title="Permalink to this definition"></a></dt>
<dd><p>z/f(x_1, …, x_n) for every variable in C and every n-ary function symbol f in the language</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.generate_new_variable">
<span class="sig-name descname"><span class="pre">generate_new_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.generate_new_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.generate_new_variable" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.generate_term_combinations">
<span class="sig-name descname"><span class="pre">generate_term_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.generate_term_combinations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.generate_term_combinations" title="Permalink to this definition"></a></dt>
<dd><p>Generate possible term list for new body atom.
Enumerate possible assignments for each place in the mode predicate,
generate all possible assignments by enumerating the combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>modeb</strong> (<a class="reference internal" href="#src.mode_declaration.ModeDeclaration" title="src.mode_declaration.ModeDeclaration"><em>ModeDeclaration</em></a>) – A mode declaration for body.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.get_max_obj_id">
<span class="sig-name descname"><span class="pre">get_max_obj_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.get_max_obj_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.get_max_obj_id" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.refine_from_modeb">
<span class="sig-name descname"><span class="pre">refine_from_modeb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.refine_from_modeb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.refine_from_modeb" title="Permalink to this definition"></a></dt>
<dd><p>Generate clauses by adding atoms to body using mode declaration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clause</strong> (<a class="reference internal" href="src.fol.html#src.fol.logic.Clause" title="src.fol.logic.Clause"><em>Clause</em></a>) – A clause.</p></li>
<li><p><strong>modeb</strong> (<a class="reference internal" href="#src.mode_declaration.ModeDeclaration" title="src.mode_declaration.ModeDeclaration"><em>ModeDeclaration</em></a>) – A mode declaration for body.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.refinement">
<span class="sig-name descname"><span class="pre">refinement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.refinement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.refinement" title="Permalink to this definition"></a></dt>
<dd><p>Perform refinement for given set of clauses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>clauses</strong> (<em>list</em><em>(</em><em>Clauses</em><em>)</em>) – A set of clauses.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A set of refined clauses using modeb declarations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list(Clauses)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.refinement_clause">
<span class="sig-name descname"><span class="pre">refinement_clause</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.refinement_clause"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.refinement_clause" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.subs_const">
<span class="sig-name descname"><span class="pre">subs_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.subs_const"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.subs_const" title="Permalink to this definition"></a></dt>
<dd><p>z/a for every variable z in C and every constant a in the language</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.refinement.RefinementGenerator.subs_var">
<span class="sig-name descname"><span class="pre">subs_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/refinement.html#RefinementGenerator.subs_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.refinement.RefinementGenerator.subs_var" title="Permalink to this definition"></a></dt>
<dd><p>z/x for every distinct variables x and z in C</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.tensor_encoder">
<span id="src-tensor-encoder-module"></span><h2>src.tensor_encoder module<a class="headerlink" href="#module-src.tensor_encoder" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.tensor_encoder.</span></span><span class="sig-name descname"><span class="pre">TensorEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The tensor encoder for differentiable inference.</p>
<p>A class for tensor encoding in differentiable forward-chaining approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lang</strong> (<em>language</em>) – The language of first-order logic.</p></li>
<li><p><strong>facts</strong> (<em>list</em><em>(</em><em>atom</em><em>)</em>) – The set of ground atoms (facts).</p></li>
<li><p><strong>clauses</strong> (<em>list</em><em>(</em><em>clause</em><em>)</em>) – The set of clauses (rules).</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to be used.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Attrs:</dt><dd><p>lang (language): The language of first-order logic.
facts (list(atom)): The set of ground atoms (facts).
clauses (list(clause)): The set of clauses (rules).
G (int): The number of ground atoms.
C (int): The number of clauses.
L (int): The maximum length of the clauses.
S (int): The maximum number of substitutions for body atoms.
head_unifier_dic ({(atom, atom) -&gt; List[(var, const)]}): The dictionary to save the computed unification results.
fact_index_dic ({atom -&gt; int}): The dictionary that maps an atom to its index.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.body_to_tensor">
<span class="sig-name descname"><span class="pre">body_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">body</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.body_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.body_to_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Convert the body atoms into a tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>body</strong> (<em>list</em><em>(</em><em>atom</em><em>)</em>) – The body atoms.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tensor representation of the body atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>I_c_b (tensor;(S * L))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.build_I_c">
<span class="sig-name descname"><span class="pre">build_I_c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clause</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.build_I_c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.build_I_c" title="Permalink to this definition"></a></dt>
<dd><p>Build index tensor for a given clause.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>clause</strong> (<em>clause</em>) – A clause.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The index tensor for the given clause (G, S, L).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>I_c (tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.build_fact_index_dic">
<span class="sig-name descname"><span class="pre">build_fact_index_dic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.build_fact_index_dic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.build_fact_index_dic" title="Permalink to this definition"></a></dt>
<dd><p>Build dictionary {fact -&gt; index}</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary to map the atoms to indices.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dic ({atom -&gt; int})</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.build_head_unifier_dic">
<span class="sig-name descname"><span class="pre">build_head_unifier_dic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.build_head_unifier_dic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.build_head_unifier_dic" title="Permalink to this definition"></a></dt>
<dd><p>Build dictionary {(head, fact) -&gt; unifier}.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary to map the pair of ground atoms to their unifier.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dic ({(atom,atom) -&gt; subtitution})</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.encode" title="Permalink to this definition"></a></dt>
<dd><p>Compute the index tensor for the differentiable inference.</p>
<p>Returns
I (tensor): The index tensor (G, C, S, L).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.facts_to_index">
<span class="sig-name descname"><span class="pre">facts_to_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.facts_to_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.facts_to_index" title="Permalink to this definition"></a></dt>
<dd><p>Convert given ground atoms into the indices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.generate_subs">
<span class="sig-name descname"><span class="pre">generate_subs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">body</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.generate_subs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.generate_subs" title="Permalink to this definition"></a></dt>
<dd><p>Generate substitutions from given body atoms.</p>
<p>Generate the possible substitutions from given list of atoms. If the body contains any variables,
then generate the substitutions by enumerating constants that matches the data type.
!!! ASSUMPTION: The body has variables that have the same data type</p>
<blockquote>
<div><p>e.g. variables O1(object) and Y(color) cannot appear in one clause !!!</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>body</strong> (<em>list</em><em>(</em><em>atom</em><em>)</em>) – The body atoms which may contain existentially quantified variables.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of substitutions of the given body atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>theta_list (list(substitution))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.get_fact_index">
<span class="sig-name descname"><span class="pre">get_fact_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fact</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.get_fact_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.get_fact_index" title="Permalink to this definition"></a></dt>
<dd><p>Convert a fact to the index in the ordered set of all facts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.get_max_subs_num">
<span class="sig-name descname"><span class="pre">get_max_subs_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clauses</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.get_max_subs_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.get_max_subs_num" title="Permalink to this definition"></a></dt>
<dd><p>Compute S (the maximum numebr of substitutions for body atoms) from clauses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>clauses</strong> (<em>list</em><em>(</em><em>clause</em><em>)</em>) – A set of clauses.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The maximum number of substitutions for existentially quantified variables in the body atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>S (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.tensor_encoder.TensorEncoder.pad_by_true">
<span class="sig-name descname"><span class="pre">pad_by_true</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/tensor_encoder.html#TensorEncoder.pad_by_true"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.tensor_encoder.TensorEncoder.pad_by_true" title="Permalink to this definition"></a></dt>
<dd><p>Fill the tensor by ones for the clause which has less body atoms than the longest clause.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tensor</em>) – The tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tensor that is padded to the shape of (S, L).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>x_padded (tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.torch_utils">
<span id="src-torch-utils-module"></span><h2>src.torch_utils module<a class="headerlink" href="#module-src.torch_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.torch_utils.logsumexp">
<span class="sig-prename descclassname"><span class="pre">src.torch_utils.</span></span><span class="sig-name descname"><span class="pre">logsumexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/torch_utils.html#logsumexp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.torch_utils.logsumexp" title="Permalink to this definition"></a></dt>
<dd><p>Numerically stable logsumexp.
from <a class="reference external" href="https://github.com/pytorch/pytorch/issues/2591#issuecomment-364474328">https://github.com/pytorch/pytorch/issues/2591#issuecomment-364474328</a>
:param inputs: A Variable with any shape.
:param dim: An integer.
:param keepdim: A boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Equivalent of log(sum(exp(inputs), dim=dim, keepdim=keepdim)).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.torch_utils.print_valuation">
<span class="sig-prename descclassname"><span class="pre">src.torch_utils.</span></span><span class="sig-name descname"><span class="pre">print_valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">valuation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/torch_utils.html#print_valuation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.torch_utils.print_valuation" title="Permalink to this definition"></a></dt>
<dd><p>Print the valuation tensor.</p>
<p>Print the valuation tensor using given atoms.
:param valuation: A valuation tensor.
:type valuation: tensor;(B*G)
:param atoms: The ground atoms.
:type atoms: list(atom)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.torch_utils.softor">
<span class="sig-prename descclassname"><span class="pre">src.torch_utils.</span></span><span class="sig-name descname"><span class="pre">softor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/torch_utils.html#softor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.torch_utils.softor" title="Permalink to this definition"></a></dt>
<dd><p>The softor function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>tensor</em><em> or </em><em>list</em><em>(</em><em>tensor</em><em>)</em>) – The input tensor.</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – The dimension to be removed.</p></li>
<li><p><strong>(</strong><strong>float</strong> (<em>gamma</em>) – The smooth parameter for logsumexp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of taking or along dim.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>log_sum_exp (tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.torch_utils.weight_sum">
<span class="sig-prename descclassname"><span class="pre">src.torch_utils.</span></span><span class="sig-name descname"><span class="pre">weight_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/torch_utils.html#weight_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.torch_utils.weight_sum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.train">
<span id="src-train-module"></span><h2>src.train module<a class="headerlink" href="#module-src.train" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.train.discretise_NSFR">
<span class="sig-prename descclassname"><span class="pre">src.train.</span></span><span class="sig-name descname"><span class="pre">discretise_NSFR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train.html#discretise_NSFR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train.discretise_NSFR" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train.get_args">
<span class="sig-prename descclassname"><span class="pre">src.train.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train.main">
<span class="sig-prename descclassname"><span class="pre">src.train.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train.predict">
<span class="sig-prename descclassname"><span class="pre">src.train.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train.train_nsfr">
<span class="sig-prename descclassname"><span class="pre">src.train.</span></span><span class="sig-name descname"><span class="pre">train_nsfr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NSFR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtpt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train.html#train_nsfr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train.train_nsfr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.train_cnn">
<span id="src-train-cnn-module"></span><h2>src.train_cnn module<a class="headerlink" href="#module-src.train_cnn" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn.compute_acc">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn.</span></span><span class="sig-name descname"><span class="pre">compute_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn.html#compute_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn.compute_acc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn.get_args">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn.main">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn.predict">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn.run">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_obj_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn.run" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.train_cnn_clevr">
<span id="src-train-cnn-clevr-module"></span><h2>src.train_cnn_clevr module<a class="headerlink" href="#module-src.train_cnn_clevr" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn_clevr.compute_acc">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn_clevr.</span></span><span class="sig-name descname"><span class="pre">compute_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn_clevr.html#compute_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn_clevr.compute_acc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn_clevr.get_args">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn_clevr.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn_clevr.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn_clevr.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn_clevr.main">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn_clevr.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn_clevr.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn_clevr.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn_clevr.predict">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn_clevr.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn_clevr.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn_clevr.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_cnn_clevr.run">
<span class="sig-prename descclassname"><span class="pre">src.train_cnn_clevr.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_obj_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_cnn_clevr.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_cnn_clevr.run" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.train_sa_mlp_clevr">
<span id="src-train-sa-mlp-clevr-module"></span><h2>src.train_sa_mlp_clevr module<a class="headerlink" href="#module-src.train_sa_mlp_clevr" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.train_sa_mlp_clevr.compute_acc">
<span class="sig-prename descclassname"><span class="pre">src.train_sa_mlp_clevr.</span></span><span class="sig-name descname"><span class="pre">compute_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_sa_mlp_clevr.html#compute_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_sa_mlp_clevr.compute_acc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_sa_mlp_clevr.get_args">
<span class="sig-prename descclassname"><span class="pre">src.train_sa_mlp_clevr.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_sa_mlp_clevr.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_sa_mlp_clevr.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_sa_mlp_clevr.main">
<span class="sig-prename descclassname"><span class="pre">src.train_sa_mlp_clevr.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_sa_mlp_clevr.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_sa_mlp_clevr.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_sa_mlp_clevr.predict">
<span class="sig-prename descclassname"><span class="pre">src.train_sa_mlp_clevr.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_sa_mlp_clevr.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_sa_mlp_clevr.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_sa_mlp_clevr.run">
<span class="sig-prename descclassname"><span class="pre">src.train_sa_mlp_clevr.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_obj_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_sa_mlp_clevr.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_sa_mlp_clevr.run" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.train_yolo_mlp">
<span id="src-train-yolo-mlp-module"></span><h2>src.train_yolo_mlp module<a class="headerlink" href="#module-src.train_yolo_mlp" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.train_yolo_mlp.compute_acc">
<span class="sig-prename descclassname"><span class="pre">src.train_yolo_mlp.</span></span><span class="sig-name descname"><span class="pre">compute_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_yolo_mlp.html#compute_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_yolo_mlp.compute_acc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_yolo_mlp.get_args">
<span class="sig-prename descclassname"><span class="pre">src.train_yolo_mlp.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_yolo_mlp.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_yolo_mlp.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_yolo_mlp.main">
<span class="sig-prename descclassname"><span class="pre">src.train_yolo_mlp.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_yolo_mlp.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_yolo_mlp.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_yolo_mlp.predict">
<span class="sig-prename descclassname"><span class="pre">src.train_yolo_mlp.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_yolo_mlp.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_yolo_mlp.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.train_yolo_mlp.run">
<span class="sig-prename descclassname"><span class="pre">src.train_yolo_mlp.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_obj_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/train_yolo_mlp.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.train_yolo_mlp.run" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-src.valuation">
<span id="src-valuation-module"></span><h2>src.valuation module<a class="headerlink" href="#module-src.valuation" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.valuation.SlotAttentionValuationModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionValuationModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#SlotAttentionValuationModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.SlotAttentionValuationModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A module to call valuation functions.
Attrs:</p>
<blockquote>
<div><p>lang (language): The language.
device (device): The device.
layers (list(nn.Module)): The list of valuation functions.
vfs (dic(str-&gt;nn.Module)): The dictionaty that maps a predicate name to the corresponding valuation function.
attrs (dic(term-&gt;tensor)): The dictionary that maps an attribute term to the corresponding one-hot encoding.
dataset (str): The dataset.</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.SlotAttentionValuationModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#SlotAttentionValuationModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.SlotAttentionValuationModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>Convert the object-centric representation to a valuation tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zs</strong> (<em>tensor</em>) – The object-centric representaion (the output of the YOLO model).</p></li>
<li><p><strong>atom</strong> (<em>atom</em>) – The target atom to compute its proability.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of the probabilities of the target atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.SlotAttentionValuationModule.ground_to_tensor">
<span class="sig-name descname"><span class="pre">ground_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#SlotAttentionValuationModule.ground_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.SlotAttentionValuationModule.ground_to_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Ground terms into tensor representations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> (<em>term</em>) – The term to be grounded.</p></li>
<li><p><strong>zs</strong> (<em>tensor</em>) – The object-centric representation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.SlotAttentionValuationModule.init_valuation_functions">
<span class="sig-name descname"><span class="pre">init_valuation_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#SlotAttentionValuationModule.init_valuation_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.SlotAttentionValuationModule.init_valuation_functions" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>device</em>) – The device.</p></li>
<li><p><strong>pretrained</strong> (<em>bool</em>) – The flag if the neural predicates are pretrained or not.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Retunrs:</dt><dd><p>layers (list(nn.Module)): The list of valuation functions.
vfs (dic(str-&gt;nn.Module)): The dictionaty that maps a predicate name to the corresponding valuation function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.SlotAttentionValuationModule.term_to_onehot">
<span class="sig-name descname"><span class="pre">term_to_onehot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#SlotAttentionValuationModule.term_to_onehot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.SlotAttentionValuationModule.term_to_onehot" title="Permalink to this definition"></a></dt>
<dd><p>Ground terms into tensor representations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> (<em>term</em>) – The term to be grounded.</p></li>
<li><p><strong>zs</strong> (<em>tensor</em>) – The object-centric representation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tensor representation of the input term.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.SlotAttentionValuationModule.to_onehot_batch">
<span class="sig-name descname"><span class="pre">to_onehot_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#SlotAttentionValuationModule.to_onehot_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.SlotAttentionValuationModule.to_onehot_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute the one-hot encoding that is expanded to the batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation.SlotAttentionValuationModule.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation.SlotAttentionValuationModule.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation.YOLOValuationModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation.</span></span><span class="sig-name descname"><span class="pre">YOLOValuationModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#YOLOValuationModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.YOLOValuationModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A module to call valuation functions.
Attrs:</p>
<blockquote>
<div><p>lang (language): The language.
device (device): The device.
layers (list(nn.Module)): The list of valuation functions.
vfs (dic(str-&gt;nn.Module)): The dictionaty that maps a predicate name to the corresponding valuation function.
attrs (dic(term-&gt;tensor)): The dictionary that maps an attribute term to the corresponding one-hot encoding.
dataset (str): The dataset.</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.YOLOValuationModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#YOLOValuationModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.YOLOValuationModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>Convert the object-centric representation to a valuation tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zs</strong> (<em>tensor</em>) – The object-centric representaion (the output of the YOLO model).</p></li>
<li><p><strong>atom</strong> (<em>atom</em>) – The target atom to compute its proability.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of the probabilities of the target atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.YOLOValuationModule.ground_to_tensor">
<span class="sig-name descname"><span class="pre">ground_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#YOLOValuationModule.ground_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.YOLOValuationModule.ground_to_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Ground terms into tensor representations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> (<em>term</em>) – The term to be grounded.</p></li>
<li><p><strong>zs</strong> (<em>tensor</em>) – The object-centric representation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tensor representation of the input term.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.YOLOValuationModule.init_attr_encodings">
<span class="sig-name descname"><span class="pre">init_attr_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#YOLOValuationModule.init_attr_encodings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.YOLOValuationModule.init_attr_encodings" title="Permalink to this definition"></a></dt>
<dd><p>Encode color and shape into one-hot encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>device</strong> (<em>device</em>) – The device.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dictionary that maps an attribute term to the corresponding one-hot encoding.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>attrs (dic(term-&gt;tensor))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation.YOLOValuationModule.init_valuation_functions">
<span class="sig-name descname"><span class="pre">init_valuation_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation.html#YOLOValuationModule.init_valuation_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation.YOLOValuationModule.init_valuation_functions" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>device</em>) – The device.</p></li>
<li><p><strong>dataset</strong> (<em>str</em>) – The dataset.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Retunrs:</dt><dd><p>layers (list(nn.Module)): The list of valuation functions.
vfs (dic(str-&gt;nn.Module)): The dictionaty that maps a predicate name to the corresponding valuation function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation.YOLOValuationModule.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation.YOLOValuationModule.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src.valuation_func">
<span id="src-valuation-func-module"></span><h2>src.valuation_func module<a class="headerlink" href="#module-src.valuation_func" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionColorValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionColorValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionColorValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionColorValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_color.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionColorValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionColorValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionColorValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p></li>
<li><p><strong>a</strong> (<em>tensor</em>) – The one-hot tensor that is expanded to the batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionColorValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionColorValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionFrontValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionFrontValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionFrontValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionFrontValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_infront.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionFrontValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionFrontValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionFrontValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionFrontValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionFrontValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionInValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionInValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionInValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionInValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_in.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionInValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionInValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionInValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p></li>
<li><p><strong>x</strong> (<em>none</em>) – A dummy argment to represent the input constant.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionInValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionInValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionLeftSideValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionLeftSideValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionLeftSideValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionLeftSideValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_leftside.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionLeftSideValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionLeftSideValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionLeftSideValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionLeftSideValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionLeftSideValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionMaterialValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionMaterialValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionMaterialValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionMaterialValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_material.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionMaterialValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionMaterialValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionMaterialValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p></li>
<li><p><strong>a</strong> (<em>tensor</em>) – The one-hot tensor that is expanded to the batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionMaterialValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionMaterialValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionRightSideValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionRightSideValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionRightSideValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionRightSideValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_rightside.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionRightSideValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionRightSideValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionRightSideValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionRightSideValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionRightSideValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionShapeValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionShapeValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionShapeValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionShapeValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_shape.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionShapeValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionShapeValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionShapeValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p></li>
<li><p><strong>a</strong> (<em>tensor</em>) – The one-hot tensor that is expanded to the batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionShapeValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionShapeValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionSizeValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">SlotAttentionSizeValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionSizeValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionSizeValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_size.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionSizeValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#SlotAttentionSizeValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.SlotAttentionSizeValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
obj_prob + coords + shape + size + material + color
[objectness, x, y, z, sphere, cube, cylinder, large, small, rubber,</p>
<blockquote>
<div><p>metal, cyan, blue, yellow, purple, red, green, gray, brown]</p>
</div></blockquote>
</p></li>
<li><p><strong>a</strong> (<em>tensor</em>) – The one-hot tensor that is expanded to the batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.SlotAttentionSizeValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.SlotAttentionSizeValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.YOLOClosebyValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">YOLOClosebyValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOClosebyValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOClosebyValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_closeby.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOClosebyValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOClosebyValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOClosebyValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_1</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
[x1, y1, x2, y2, color1, color2, color3,</p>
<blockquote>
<div><p>shape1, shape2, shape3, objectness]</p>
</div></blockquote>
</p></li>
<li><p><strong>z_2</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
[x1, y1, x2, y2, color1, color2, color3,</p>
<blockquote>
<div><p>shape1, shape2, shape3, objectness]</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOClosebyValuationFunction.to_center">
<span class="sig-name descname"><span class="pre">to_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOClosebyValuationFunction.to_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOClosebyValuationFunction.to_center" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.YOLOClosebyValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.YOLOClosebyValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.YOLOColorValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">YOLOColorValuationFunction</span></span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOColorValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOColorValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_color.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOColorValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOColorValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOColorValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor B * d of object-centric representation.
[x1, y1, x2, y2, color1, color2, color3,</p>
<blockquote>
<div><p>shape1, shape2, shape3, objectness]</p>
</div></blockquote>
</p></li>
<li><p><strong>a</strong> (<em>tensor</em>) – The one-hot tensor that is expanded to the batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.YOLOColorValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.YOLOColorValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.YOLOInValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">YOLOInValuationFunction</span></span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOInValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOInValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_in.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOInValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOInValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOInValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
[x1, y1, x2, y2, color1, color2, color3,</p>
<blockquote>
<div><p>shape1, shape2, shape3, objectness]</p>
</div></blockquote>
</p></li>
<li><p><strong>x</strong> (<em>none</em>) – A dummy argment to represent the input constant.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.YOLOInValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.YOLOInValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.YOLOOnlineValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">YOLOOnlineValuationFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOOnlineValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOOnlineValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_online.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOOnlineValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOOnlineValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOOnlineValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><p>The function to compute the probability of the online predicate.</p>
<p>The closed form of the linear regression is computed.
The error value is fed into the 1-d logistic regression function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z_i</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
[x1, y1, x2, y2, color1, color2, color3,</p>
<blockquote>
<div><p>shape1, shape2, shape3, objectness]</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOOnlineValuationFunction.to_center_x">
<span class="sig-name descname"><span class="pre">to_center_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOOnlineValuationFunction.to_center_x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOOnlineValuationFunction.to_center_x" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOOnlineValuationFunction.to_center_y">
<span class="sig-name descname"><span class="pre">to_center_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOOnlineValuationFunction.to_center_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOOnlineValuationFunction.to_center_y" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.YOLOOnlineValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.YOLOOnlineValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.valuation_func.YOLOShapeValuationFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.valuation_func.</span></span><span class="sig-name descname"><span class="pre">YOLOShapeValuationFunction</span></span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOShapeValuationFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOShapeValuationFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The function v_shape.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.valuation_func.YOLOShapeValuationFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/valuation_func.html#YOLOShapeValuationFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.valuation_func.YOLOShapeValuationFunction.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>tensor</em>) – <p>2-d tensor (B * D), the object-centric representation.
[x1, y1, x2, y2, color1, color2, color3,</p>
<blockquote>
<div><p>shape1, shape2, shape3, objectness]</p>
</div></blockquote>
</p></li>
<li><p><strong>a</strong> (<em>tensor</em>) – The one-hot tensor that is expanded to the batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A batch of probabilities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.valuation_func.YOLOShapeValuationFunction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#src.valuation_func.YOLOShapeValuationFunction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-src" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="acknowledgements.html" class="btn btn-neutral float-left" title="Acknowledgements" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="src.fol.html" class="btn btn-neutral float-right" title="src.fol package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, HikaruShindo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search,
    .wy-nav-top {
        background: #080a52ff;
    }

    /* Sidebar */
    .wy-nav-side {
        background: #080a52ff;
    }
</style>


</body>
</html>